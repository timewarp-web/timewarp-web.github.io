<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="description" content="TimeWarp: Evaluating Web Agents by Revisiting the Past">
  <meta name="keywords" content="Scene Generation, Simulation, Indoor Scenes, VLM, Agents">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Tags for link preview -->
  <meta property="og:title" content="TimeWarp: Evaluating Web Agents by Revisiting the Past" />
  <meta property="og:description"
    content="A hierarchical agentic framework that generates simulation-ready indoor environments from natural language prompts." />
  <meta property="og:url" content="https://scenesmith.github.io/" />
  <meta property="og:image" content="https://scenesmith.github.io/static/images/teaser.webp" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:type" content="website" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:image" content="https://scenesmith.github.io/static/images/teaser.webp" />

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-9RH5ZJ2FEL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-9RH5ZJ2FEL');
  </script>

  <link rel="icon" type="image/png" href="static/favicon/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="static/favicon/favicon.svg" />
  <link rel="shortcut icon" href="static/favicon/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="static/favicon/apple-touch-icon.png" />

  <title>TimeWarp: Evaluating Web Agents by Revisiting the Past</title>

  <!-- Three.js import map - MUST come before any module scripts -->
  <script type="importmap">
  {
    "imports": {
      "three": "https://cdn.jsdelivr.net/npm/three@0.169.0/build/three.module.js",
      "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.169.0/examples/jsm/"
    }
  }
  </script>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script type="text/javascript" src="https://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
  <script src="https://unpkg.com/interactjs/dist/interact.min.js"></script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

  <link rel="stylesheet" type="text/css" href="./static/slick/slick.css" />
  <link rel="stylesheet" type="text/css" href="./static/slick/slick-theme.css" />

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/@creativebulma/bulma-tooltip@1.2.0/dist/bulma-tooltip.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="stylesheet" href="./static/css/viewer.css">
  <link rel="preload" href="./static/videos/teaser_new.mp4" as="video" type="video/mp4">

  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script type="text/javascript" src="./static/slick/slick.min.js"></script>
  <script src="./static/js/index.js"></script>
  <script src="./static/js/vis.js" defer></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>



<body>

  <!-- Sticky Navigation -->
  <nav class="site-nav" id="site-nav">
    <div class="nav-inner">
      <a href="#" class="nav-brand">
        <img src="./static/images/symbol_no_text.svg" alt=""> TimeWarp
      </a>
      <div class="nav-links">
        <a href="#buildup-section">Construction</a>
        <a href="#rby1-teleoperation-section">Teleoperation</a>
        <a href="#text-to-scene-section">Text-to-Scene</a>
        <a href="#earthquake-section">Simulation</a>
        <a href="#room-scenes-section">Room Scenes</a>
        <a href="#house-scenes-section">House Scenes</a>
        <a href="#robot-eval-section">Robot Eval</a>
        <a href="#bibtex-section">Citation</a>
        <div class="nav-dropdown">
          <a class="nav-dropdown-trigger">More Research <span style="font-size: 0.6em;">&#9662;</span></a>
          <div class="nav-dropdown-content">
            <a href="https://steerable-scene-generation.github.io" target="_blank" rel="noopener noreferrer">Steerable
              Scene Generation</a>
            <a href="https://scalable-real2sim.github.io" target="_blank" rel="noopener noreferrer">Scalable
              Real2Sim</a>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- Hero Section with Background Video -->
  <section class="hero-section" id="hero">
    <!-- Background video -->
    <div class="hero-video-bg">
      <video id="hero-video" muted autoplay loop playsinline preload="auto"
        poster="./static/videos/teaser_poster_tw.png">
        <source src="./static/videos/teaser_new.mp4" type="video/mp4">
      </video>
      <script>
        // Recover from CDN stalls on GitHub Pages
        (function () {
          var v = document.getElementById('hero-video');
          v.addEventListener('stalled', function () { v.load(); });
          v.addEventListener('waiting', function () {
            setTimeout(function () { if (v.paused) v.play(); }, 2000);
          });
        })();
      </script>
    </div>
    <!-- Dark overlay gradient -->
    <div class="hero-overlay"></div>
    <!-- Animated orbs (mobile fallback, hidden on desktop) -->
    <div class="hero-orb hero-orb-1"></div>
    <div class="hero-orb hero-orb-2"></div>
    <div class="hero-orb hero-orb-3"></div>
    <!-- Institutional logos (top corners on desktop, centered top on mobile) -->
    <div class="hero-logos">
      <a href="https://www.utah.edu/" target="_blank" rel="noopener noreferrer" class="hero-logo-link" id="utah-link">
        <img src="./static/images/university-of-utah-logo.svg" alt="University of Utah" class="hero-logo"
          id="utah-logo">
      </a>
      <a href="https://sparklabutah.github.io/" target="_blank" rel="noopener noreferrer" class="hero-logo-link">
        <img src="./static/images/sparkLab.png" alt="Spark Lab Utah" class="hero-logo" id="spark-logo">
      </a>
    </div>
    <!-- Content -->
    <div class="hero-content-wrapper">
      <div class="container is-max-widescreen">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <div class="hero-title-container">
              <h1 class="title is-1 publication-title">
                <span class="accent-text">TimeWarp:</span> Evaluating Web Agents by Revisiting the Past
              </h1>
              <p class="publication-authors">
                <a href="https://farhanishmam.github.io/" target="_blank" rel="noopener noreferrer">Md Farhan
                  Ishmam</a> and
                <a href="https://kennethmarino.com/" target="_blank" rel="noopener noreferrer">Kenneth Marino</a>
              </p>
            </div>
            <div class="column has-text-centered">
              <div class="publication-links">
                <span class="link-block">
                  <a href="https://arxiv.org/abs/2602.09153" class="external-link button is-normal is-rounded"
                    target="_blank">
                    <span class="icon"><i class="ai ai-arxiv"></i></span>
                    <span>arXiv</span>
                  </a>
                </span>
                <span class="link-block">
                  <a href="https://youtu.be/V5Sg2NPqJb8" class="external-link button is-normal is-rounded"
                    target="_blank">
                    <span class="icon"><i class="fab fa-youtube"></i></span>
                    <span>Video</span>
                  </a>
                </span>
                <span class="link-block">
                  <a href="https://github.com/nepfaff/scenesmith" class="external-link button is-normal is-rounded"
                    target="_blank">
                    <span class="icon"><i class="fab fa-github"></i></span>
                    <span>Code</span>
                  </a>
                </span>
                <span class="link-block">
                  <a href="https://huggingface.co/datasets/nepfaff/scenesmith-example-scenes"
                    class="external-link button is-normal is-rounded" target="_blank">
                    <span class="icon"><i class="fas fa-database"></i></span>
                    <span>Scene Dataset</span>
                  </a>
                </span>
                <span class="link-block">
                  <a href="https://x.com/NicholasEPfaff/status/2021626601780174969"
                    class="external-link button is-normal is-rounded" target="_blank">
                    <span class="icon"><i class="fab fa-twitter"></i></span>
                    <span>X Post</span>
                  </a>
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>


  <!-- Teaser Video Section -->
  <!-- <section class="section" style="padding-top: 0;">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-full-width">
          <div class="content has-text-centered"
            style="background-color: #f5f5f5; border-radius: 8px; aspect-ratio: 16 / 9; display: flex; align-items: center; justify-content: center;">
            <p style="color: #888;">
              <i class="fab fa-youtube fa-3x"></i><br><br>
              Teaser video placeholder
            </p>
          </div>
        </div>
      </div>
    </div>
  </section> -->

  <!-- <section class="section">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-3">Abstract</h2>
          <div class="content has-text-justified">
            <p>
              Simulation has become a key tool for training and evaluating home robots at scale, yet existing
              environments fail to capture the diversity and physical complexity of real indoor spaces. Current scene
              synthesis methods produce sparsely furnished rooms that lack the dense clutter, articulated furniture, and
              physical properties essential for robotic manipulation. We introduce SceneSmith, a hierarchical agentic
              framework that generates simulation-ready indoor environments from natural language prompts. SceneSmith
              constructs scenes through successive stages—from architectural layout to furniture placement to small
              object population—each implemented as an interaction among VLM agents: designer, critic, and orchestrator.
              The framework tightly integrates asset generation through text-to-3D synthesis for static objects, dataset
              retrieval for articulated objects, and physical property estimation. SceneSmith generates 3-6x more
              objects than prior methods, with no inter-object collisions and 96% of objects remaining stable under
              physics simulation. In a user study with 205 participants, it achieves 92% average realism and 91%
              average prompt faithfulness win rates against baselines. We further demonstrate that these environments
              can be used in an end-to-end pipeline for automatic robot policy evaluation.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section> -->


  <!-- Micro-Abstract -->
  <section class="section" id="about-section" style="padding-top: 3.5rem; padding-bottom: 2.5rem;">
    <div class="container is-max-widescreen">
      <div class="info-callout fade-in" style="max-width: 900px; margin: 0 auto; border-left-width: 5px;">
        <p style="font-size: 1.05rem; line-height: 1.7;">
          <strong>TimeWarp</strong> is a benchmark designed to evaluate the robustness of agents to the evolving web.
          TimeWarp consists of three web environments: <i>Wiki</i>, <i>News</i>, and <i>Shop</i>, each with six UI versions
          across different eras of the internet. The environments are lightweight, extensible, and tighyly integrated with the popular web agent
          framework, BrowserGym. The TimeWarp benchmark also includes <strong>TimeTraj</strong>, a method for scalably collecting
          trajectories via human plans, and <strong>TimeWarp-BC</strong>, a variant of Behavior Cloning (BC) to train agents better via
          knowledge distillation on tasks that require memory and planning.
        </p>
      </div>
    </div>
  </section>

  <!-- Scene Buildup Section -->
  <section class="section section-alt" id="buildup-section">
    <div class="container is-max-widescreen">
      <h2 class="title is-3 has-text-centered fade-in">Scene Construction</h2>
      <div id="buildup-carousel" class="carousel">
        <div class="results-item">
          <div class="prompt-tooltip-wrap">
            <p class="has-text-centered has-text-grey is-italic mb-2">&ldquo;A dining room with a long table set for 12
              people&hellip;&rdquo; <span class="prompt-hover-hint">(hover for full prompt)</span></p>
            <div class="prompt-tooltip-box">&ldquo;A dining room with a long table set for 12 people. Each setting has a
              small plate stacked on a large plate, a glass, a fork, and a knife.&rdquo;</div>
          </div>
          <div class="video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls data-src="./static/videos/scene_buildup/158.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
          </div>
        </div>
        <div class="results-item">
          <div class="prompt-tooltip-wrap">
            <p class="has-text-centered has-text-grey is-italic mb-2">&ldquo;A bookstore with at least 50 books.&rdquo;
            </p>
          </div>
          <div class="video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls data-src="./static/videos/scene_buildup/174.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
          </div>
        </div>
        <div class="results-item">
          <div class="prompt-tooltip-wrap">
            <p class="has-text-centered has-text-grey is-italic mb-2">&ldquo;A cafe with a bar counter, small round
              tables, and a chalkboard menu&hellip;&rdquo; <span class="prompt-hover-hint">(hover for full
                prompt)</span></p>
            <div class="prompt-tooltip-box">&ldquo;A cafe with a bar counter along one wall featuring a coffee machine,
              a filter coffee stand, and stacks of stone coffee cups. Three small round tables with two chairs each are
              arranged in the center. A chalkboard menu hangs on the wall behind the counter.&rdquo;</div>
          </div>
          <div class="video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls data-src="./static/videos/scene_buildup/111.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
          </div>
        </div>
        <div class="results-item">
          <div class="prompt-tooltip-wrap">
            <p class="has-text-centered has-text-grey is-italic mb-2">&ldquo;A robotics lab with workbenches, robotic
              arms, and a 3D printer&hellip;&rdquo; <span class="prompt-hover-hint">(hover for full prompt)</span></p>
            <div class="prompt-tooltip-box">&ldquo;A robotics lab with two workbenches with robotic arms. Tool shelves
              on the wall hold tools, and a 3D printer sits in the corner.&rdquo;</div>
          </div>
          <div class="video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls data-src="./static/videos/scene_buildup/132.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
          </div>
        </div>
        <div class="results-item">
          <div class="prompt-tooltip-wrap">
            <p class="has-text-centered has-text-grey is-italic mb-2">&ldquo;A yoga studio with yoga mats, a wall
              mirror, and meditation cushions&hellip;&rdquo; <span class="prompt-hover-hint">(hover for full
                prompt)</span></p>
            <div class="prompt-tooltip-box">&ldquo;A yoga studio with yoga mats on the floor, a mirror on the wall, and
              meditation cushions in the corner.&rdquo;</div>
          </div>
          <div class="video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls data-src="./static/videos/scene_buildup/129.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
          </div>
        </div>
        <div class="results-item">
          <div class="prompt-tooltip-wrap">
            <p class="has-text-centered has-text-grey is-italic mb-2">&ldquo;A small family home with a master bedroom,
              a kids room, a living-dining room, a kitchen, a hallway, and a bathroom&hellip;&rdquo; <span
                class="prompt-hover-hint">(hover for full prompt)</span></p>
            <div class="prompt-tooltip-box">&ldquo;A small family home with a master bedroom, a kids room, a
              living-dining room, a kitchen, a hallway, and a bathroom. The master bedroom has a bed and a dresser. The
              kids room has a bunk bed and a toy box. The living-dining room has a sofa, a dining table with four
              chairs, and a TV. The kitchen has a refrigerator and a stove. The hallway has a coat rack and a shoe
              cabinet. The bathroom has a toilet, a sink, and a bathtub.&rdquo;</div>
          </div>
          <div class="video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls
              data-src="./static/videos/scene_buildup/full_house_buildup_animation.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
          </div>
        </div>
      </div>
      <div class="info-callout fade-in" style="margin-top: 1.5rem; margin-bottom: 1.5rem;">
        <p>
          SceneSmith constructs scenes through five successive stages, each implemented as an interaction among three
          VLM agents: a <strong>designer</strong> that proposes object placements, a <strong>critic</strong> that
          evaluates realism and coherence, and an <strong>orchestrator</strong> that mediates between the two.
        </p>
      </div>
      <!-- Pipeline Stages -->
      <div class="pipeline-stages fade-in">
        <div class="pipeline-stage">
          <div class="stage-num">1</div>
          <div class="stage-title">Layout</div>
          <div class="stage-desc">Architectural floorplan</div>
        </div>
        <div class="pipeline-stage">
          <div class="stage-num">2</div>
          <div class="stage-title">Furniture</div>
          <div class="stage-desc">Furniture placement</div>
        </div>
        <div class="pipeline-stage">
          <div class="stage-num">3</div>
          <div class="stage-title">Wall-mounted</div>
          <div class="stage-desc">Shelves, mirrors, art</div>
        </div>
        <div class="pipeline-stage">
          <div class="stage-num">4</div>
          <div class="stage-title">Ceiling-mounted</div>
          <div class="stage-desc">Lights and fans</div>
        </div>
        <div class="pipeline-stage">
          <div class="stage-num">5</div>
          <div class="stage-title">Manipulands</div>
          <div class="stage-desc">Small interactive objects</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Robot Teleoperation Section -->
  <section class="section" id="rby1-teleoperation-section">
    <div class="container is-max-widescreen">
      <h2 class="title is-3 has-text-centered fade-in">Robot Teleoperation in Generated Scenes</h2>
      <div class="content has-text-justified mb-5">
        <p>
          SceneSmith scenes are simulation-ready and can be directly used for robotics tasks.
          Here we demonstrate this by teleoperating a Rainbow RBY1
          robot in generated scenes using the Drake simulator.
        </p>
      </div>

      <div id="rby1-carousel" class="carousel">
        <!-- Slide 1: hallway cabinet -->
        <div class="results-item">
          <div class="video-wrapper rby1-video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls
              data-src="./static/videos/rby1/rby1_hallway_cabinet.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
            <span class="video-view-label video-view-label-left">Third Person</span>
            <span class="video-view-label video-view-label-right">Head View</span>
          </div>
        </div>
        <!-- Slide 2: bar glass -->
        <div class="results-item">
          <div class="video-wrapper rby1-video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls data-src="./static/videos/rby1/rby1_bar_glass.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
            <span class="video-view-label video-view-label-left">Third Person</span>
            <span class="video-view-label video-view-label-right">Head View</span>
          </div>
        </div>
        <!-- Slide 3: house tour (navigation) -->
        <div class="results-item">
          <div class="video-wrapper rby1-video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls data-src="./static/videos/rby1/rby1_house_tour.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
            <span class="video-view-label video-view-label-left">Third Person</span>
            <span class="video-view-label video-view-label-right">Head View</span>
          </div>
        </div>
        <!-- Slide 4: kids bedroom bin -->
        <div class="results-item">
          <div class="video-wrapper rby1-video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls data-src="./static/videos/rby1/rby1_kids_br_bin.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
            <span class="video-view-label video-view-label-left">Third Person</span>
            <span class="video-view-label video-view-label-right">Head View</span>
          </div>
        </div>
        <!-- Slide 5: grocery beans -->
        <div class="results-item">
          <div class="video-wrapper rby1-video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls data-src="./static/videos/rby1/rby1_grocery_beans.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
            <span class="video-view-label video-view-label-left">Third Person</span>
            <span class="video-view-label video-view-label-right">Head View</span>
          </div>
        </div>
        <!-- Slide 6: living room candle -->
        <div class="results-item">
          <div class="video-wrapper rby1-video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls
              data-src="./static/videos/rby1/rby1_living_rm_candle.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
            <span class="video-view-label video-view-label-left">Third Person</span>
            <span class="video-view-label video-view-label-right">Head View</span>
          </div>
        </div>
        <!-- Slide 7: kitchen mug -->
        <div class="results-item">
          <div class="video-wrapper rby1-video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls data-src="./static/videos/rby1/rby1_kitchen_mug.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
            <span class="video-view-label video-view-label-left">Third Person</span>
            <span class="video-view-label video-view-label-right">Head View</span>
          </div>
        </div>
        <!-- Slide 8: hallway bag 0 -->
        <div class="results-item">
          <div class="video-wrapper rby1-video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls data-src="./static/videos/rby1/rby1_hallway_bag_0.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
            <span class="video-view-label video-view-label-left">Third Person</span>
            <span class="video-view-label video-view-label-right">Head View</span>
          </div>
        </div>
        <!-- Slide 9: kids bedroom blocks -->
        <div class="results-item">
          <div class="video-wrapper rby1-video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls data-src="./static/videos/rby1/rby1_kids_br_blocks.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
            <span class="video-view-label video-view-label-left">Third Person</span>
            <span class="video-view-label video-view-label-right">Head View</span>
          </div>
        </div>
        <!-- Slide 10: hallway bag 1 -->
        <div class="results-item">
          <div class="video-wrapper rby1-video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls data-src="./static/videos/rby1/rby1_hallway_bag_1.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
            <span class="video-view-label video-view-label-left">Third Person</span>
            <span class="video-view-label video-view-label-right">Head View</span>
          </div>
        </div>
        <!-- Slide 11: kids bedroom bunny -->
        <div class="results-item">
          <div class="video-wrapper rby1-video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls data-src="./static/videos/rby1/rby1_kids_br_bunny.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
            <span class="video-view-label video-view-label-left">Third Person</span>
            <span class="video-view-label video-view-label-right">Head View</span>
          </div>
        </div>
        <!-- Slide 12: living room vase -->
        <div class="results-item">
          <div class="video-wrapper rby1-video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls data-src="./static/videos/rby1/rby1_living_rm_vase.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
            <span class="video-view-label video-view-label-left">Third Person</span>
            <span class="video-view-label video-view-label-right">Head View</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Text-to-Scene Section -->
  <section class="section section-alt" id="text-to-scene-section">
    <div class="container is-max-widescreen">
      <h2 class="title is-3 has-text-centered fade-in">Open-Vocabulary Text-to-Scene Generation</h2>
      <div class="video-wrapper"
        style="position: relative; display: block; width: 100%; aspect-ratio: 16 / 9; margin: 0 auto;">
        <video id="text-to-scene-video" class="lazy-video" muted playsinline loop
          data-src="./static/videos/scene_buildup/Scene_Buildup_Animation_small.mp4"
          style="width: 100%; height: 100%; object-fit: contain;"></video>
        <div class="video-spinner"></div>
        <div class="video-play-indicator" id="text-to-scene-play-indicator">
          <svg width="14" height="16" viewBox="0 0 14 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M13 7.134a1 1 0 0 1 0 1.732l-11.5 6.64A1 1 0 0 1 0 14.64V1.36A1 1 0 0 1 1.5.494L13 7.134z"
              fill="#fff" />
          </svg>
        </div>
      </div>
      <div class="content has-text-justified mt-4">
        <p>
          SceneSmith supports open-vocabulary text input for generating arbitrary indoor scenes,
          from single rooms to multi-room house-scale environments. The object vocabulary is also unbounded,
          as SceneSmith leverages text-to-3D generation to create any object on demand.
        </p>
      </div>
    </div>
  </section>

  <!-- Earthquake Simulation Section -->
  <section class="section section-alt" id="earthquake-section">
    <div class="container is-max-widescreen">
      <h2 class="title is-3 has-text-centered fade-in">Simulation-Ready Scenes</h2>
      <div class="video-wrapper"
        style="position: relative; display: block; width: 100%; aspect-ratio: 16 / 9; margin: 0 auto;">
        <video id="earthquake-video" class="lazy-video" muted playsinline loop
          data-src="./static/videos/Earthquake_Sims_Animation_small.mp4"
          style="width: 100%; height: 100%; object-fit: contain;"></video>
        <div class="video-spinner"></div>
      </div>
      <div class="content has-text-justified mt-4">
        <p>
          All furniture and manipulands in SceneSmith-generated scenes are fully
          movable in simulation. The video above demonstrates this by applying
          earthquake-style shaking to entire scenes, showing that every placed
          object responds to physical forces.
        </p>
      </div>
    </div>
  </section>

  <!-- Room-Scale Scenes Section -->
  <section class="section viewer-section" id="room-scenes-section">
    <div class="container is-max-widescreen">
      <h2 class="title is-3 has-text-centered fade-in">Room-Scale Scenes</h2>
      <div class="content has-text-centered">
        <p>
          Select a scene to explore. Click objects to view them in isolation.
        </p>
        <p class="has-text-grey is-size-7 quality-note">
          <i class="fas fa-info-circle"></i> Scenes shown are slightly lower quality than originals due to compression,
          mesh decimation, and texture downsampling for faster web loading.
        </p>
      </div>

      <!-- Scene selector -->
      <div class="scene-selector-wrapper">
        <div class="field has-addons">
          <div class="control is-expanded">
            <div class="select is-fullwidth">
              <select id="room-selector">
                <option value="">Choose a scene...</option>
              </select>
            </div>
          </div>
          <div class="control">
            <button class="button is-info" id="room-random-btn" title="Load random scene">
              <span class="icon"><i class="fas fa-random"></i></span>
            </button>
          </div>
        </div>
        <div class="field">
          <div class="control has-icons-left">
            <input class="input" type="text" id="room-search" placeholder="Type to filter scenes...">
            <span class="icon is-left"><i class="fas fa-search"></i></span>
          </div>
        </div>
      </div>

      <!-- Prompt display -->
      <div class="notification is-info is-light prompt-display" id="room-prompt">
        <span class="prompt-placeholder">Select a scene to see its prompt</span>
      </div>

      <!-- Viewer layout -->
      <div class="columns">
        <div class="column is-8">
          <div class="box viewer-box" id="room-viewer">
            <!-- Progress bar -->
            <div class="progress-wrapper is-hidden" id="room-progress">
              <p class="progress-text">Loading scene...</p>
              <progress class="progress is-primary" max="100" value="0">0%</progress>
            </div>
            <!-- Floating controls -->
            <div class="viewer-controls">
              <button class="button is-small" id="room-help-btn" title="Help">
                <span class="icon"><i class="fas fa-question"></i></span>
              </button>
              <button class="button is-small" id="room-frame-btn" title="Frame selected (F)" style="display: none;">
                <span class="icon"><i class="fas fa-crosshairs"></i></span>
              </button>
              <button class="button is-small" id="room-hide-btn" title="Hide selected (H)" style="display: none;">
                <span class="icon"><i class="fas fa-eye-slash"></i></span>
              </button>
              <button class="button is-small is-warning" id="room-show-all-btn" title="Show all hidden"
                style="display: none;">
                <span class="icon"><i class="fas fa-eye"></i></span>
                <span>Show <span id="room-hidden-count">0</span></span>
              </button>
              <button class="button is-small" id="room-reset-btn" title="Reset camera (R)">
                <span class="icon"><i class="fas fa-undo"></i></span>
              </button>
              <button class="button is-small" id="room-fullscreen-btn" title="Fullscreen">
                <span class="icon"><i class="fas fa-expand"></i></span>
              </button>
            </div>
            <!-- Help tooltip -->
            <div class="help-tooltip" id="room-help">
              <ul>
                <li><strong>Rotate:</strong> Left-click + drag</li>
                <li><strong>Pan:</strong> Right-click + drag</li>
                <li><strong>Zoom:</strong> Scroll wheel</li>
                <li><strong>Select:</strong> Click on object</li>
                <li><kbd>F</kbd> Frame selected object</li>
                <li><kbd>H</kbd> Hide selected object</li>
                <li><kbd>R</kbd> Reset camera</li>
                <li><kbd>C</kbd> Clear selection
                <li><kbd>S</kbd> Show all hidden</li>
              </ul>
            </div>
          </div>
        </div>
        <div class="column is-4">
          <div class="box selection-panel">
            <h4 class="title is-5">Selected Object</h4>
            <p id="room-no-selection" class="no-selection">Click an object in the scene to select it</p>
            <div id="room-selection-info" class="is-hidden">
              <div id="room-meta-name" class="meta-name"></div>
              <div id="room-meta-tags" class="meta-tags"></div>
              <div id="room-meta-mass" class="meta-mass"></div>
              <div class="overlay-controls">
                <button class="button is-small is-outlined" id="room-collision-btn" style="display:none;">
                  <span class="icon"><i class="fas fa-cubes"></i></span>
                  <span>Collision</span>
                </button>
                <button class="button is-small is-outlined" id="room-inertia-btn" style="display:none;">
                  <span class="icon"><i class="fas fa-atom"></i></span>
                  <span>Inertia</span>
                </button>
              </div>
              <div class="isolated-viewer-wrapper" id="room-isolated-wrapper">
                <div class="isolated-viewer" id="room-isolated-viewer"></div>
                <button class="button is-small isolated-fullscreen-btn" id="room-isolated-fullscreen-btn"
                  title="Fullscreen">
                  <span class="icon"><i class="fas fa-expand"></i></span>
                </button>
              </div>
              <div id="room-joint-controls" class="joint-controls"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- House-Scale Scenes Section -->
  <section class="section section-alt viewer-section" id="house-scenes-section">
    <div class="container is-max-widescreen">
      <h2 class="title is-3 has-text-centered fade-in">House-Scale Scenes</h2>
      <div class="content has-text-centered">
        <p>
          Multi-room environments with complex layouts. Select a scene to explore.
        </p>
        <p class="has-text-grey is-size-7 quality-note">
          <i class="fas fa-info-circle"></i> House scenes are larger and may take longer to load.
        </p>
      </div>

      <!-- Scene selector -->
      <div class="scene-selector-wrapper">
        <div class="field has-addons">
          <div class="control is-expanded">
            <div class="select is-fullwidth">
              <select id="house-selector">
                <option value="">Choose a scene...</option>
              </select>
            </div>
          </div>
          <div class="control">
            <button class="button is-info" id="house-random-btn" title="Load random scene">
              <span class="icon"><i class="fas fa-random"></i></span>
            </button>
          </div>
        </div>
        <div class="field">
          <div class="control has-icons-left">
            <input class="input" type="text" id="house-search" placeholder="Type to filter scenes...">
            <span class="icon is-left"><i class="fas fa-search"></i></span>
          </div>
        </div>
      </div>

      <!-- Prompt display -->
      <div class="notification is-info is-light prompt-display" id="house-prompt">
        <span class="prompt-placeholder">Select a scene to see its prompt</span>
      </div>

      <!-- Viewer layout -->
      <div class="columns">
        <div class="column is-8">
          <div class="box viewer-box" id="house-viewer">
            <!-- Progress bar -->
            <div class="progress-wrapper is-hidden" id="house-progress">
              <p class="progress-text">Loading scene...</p>
              <progress class="progress is-primary" max="100" value="0">0%</progress>
            </div>
            <!-- Floating controls -->
            <div class="viewer-controls">
              <button class="button is-small" id="house-help-btn" title="Help">
                <span class="icon"><i class="fas fa-question"></i></span>
              </button>
              <button class="button is-small" id="house-frame-btn" title="Frame selected (F)" style="display: none;">
                <span class="icon"><i class="fas fa-crosshairs"></i></span>
              </button>
              <button class="button is-small" id="house-hide-btn" title="Hide selected (H)" style="display: none;">
                <span class="icon"><i class="fas fa-eye-slash"></i></span>
              </button>
              <button class="button is-small is-warning" id="house-show-all-btn" title="Show all hidden"
                style="display: none;">
                <span class="icon"><i class="fas fa-eye"></i></span>
                <span>Show <span id="house-hidden-count">0</span></span>
              </button>
              <button class="button is-small" id="house-reset-btn" title="Reset camera (R)">
                <span class="icon"><i class="fas fa-undo"></i></span>
              </button>
              <button class="button is-small" id="house-fullscreen-btn" title="Fullscreen">
                <span class="icon"><i class="fas fa-expand"></i></span>
              </button>
            </div>
            <!-- Help tooltip -->
            <div class="help-tooltip" id="house-help">
              <ul>
                <li><strong>Rotate:</strong> Left-click + drag</li>
                <li><strong>Pan:</strong> Right-click + drag</li>
                <li><strong>Zoom:</strong> Scroll wheel</li>
                <li><strong>Select:</strong> Click on object</li>
                <li><kbd>F</kbd> Frame selected object</li>
                <li><kbd>H</kbd> Hide selected object</li>
                <li><kbd>R</kbd> Reset camera</li>
                <li><kbd>C</kbd> Clear selection
                <li><kbd>S</kbd> Show all hidden</li>
              </ul>
            </div>
          </div>
        </div>
        <div class="column is-4">
          <div class="box selection-panel">
            <h4 class="title is-5">Selected Object</h4>
            <p id="house-no-selection" class="no-selection">Click an object in the scene to select it</p>
            <div id="house-selection-info" class="is-hidden">
              <div id="house-meta-name" class="meta-name"></div>
              <div id="house-meta-tags" class="meta-tags"></div>
              <div id="house-meta-mass" class="meta-mass"></div>
              <div class="overlay-controls">
                <button class="button is-small is-outlined" id="house-collision-btn" style="display:none;">
                  <span class="icon"><i class="fas fa-cubes"></i></span>
                  <span>Collision</span>
                </button>
                <button class="button is-small is-outlined" id="house-inertia-btn" style="display:none;">
                  <span class="icon"><i class="fas fa-atom"></i></span>
                  <span>Inertia</span>
                </button>
              </div>
              <div class="isolated-viewer-wrapper" id="house-isolated-wrapper">
                <div class="isolated-viewer" id="house-isolated-viewer"></div>
                <button class="button is-small isolated-fullscreen-btn" id="house-isolated-fullscreen-btn"
                  title="Fullscreen">
                  <span class="icon"><i class="fas fa-expand"></i></span>
                </button>
              </div>
              <div id="house-joint-controls" class="joint-controls"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Robot Manipulation Evaluation Section -->
  <section class="section" id="robot-eval-section">
    <div class="container is-max-widescreen">
      <h2 class="title is-3 has-text-centered fade-in">Application: Automatic Robot Policy Evaluation</h2>

      <!-- Pipeline figure -->
      <div class="content has-text-centered">
        <img src="./static/images/robot_eval.webp" alt="Robot manipulation evaluation pipeline diagram"
          style="width: 100%;">
      </div>
      <div class="content has-text-justified" style="margin-top: 1em; margin-bottom: 2em;">
        <p>
          <strong>Robot manipulation evaluation pipeline.</strong> Given a manipulation task
          (e.g., &ldquo;Pick a fruit from the fruit bowl and place it on a plate&rdquo;), an LLM
          generates diverse scene prompts specifying scene constraints implied by the task. SceneSmith
          generates scenes from each prompt. A robot policy attempts the task in simulation, and an
          evaluation agent verifies success using simulator state queries and visual observations. This enables
          scalable policy evaluation without manual environment or success predicate design.
        </p>
      </div>

      <!-- Robot rollout video carousel -->
      <div id="robot-eval-carousel" class="carousel">
        <!-- Slide 1: Overview animation (NO controls) -->
        <div class="results-item">
          <p class="has-text-centered has-text-grey is-italic mb-2">&nbsp;</p>
          <div class="video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline data-src="./static/videos/robot_eval/Robot_Eval_Animation.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
          </div>
        </div>
        <!-- Slide 2: coke can 214 -->
        <div class="results-item">
          <p class="has-text-centered has-text-grey is-italic mb-2">&ldquo;Pick a coke can from the shelf and place it
            on the table&rdquo;</p>
          <div class="video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls
              data-src="./static/videos/robot_eval/room_coke_can_scene_214_good.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
          </div>
        </div>
        <!-- Slide 3: water bottle 000 -->
        <div class="results-item">
          <p class="has-text-centered has-text-grey is-italic mb-2">&ldquo;Bring the water bottle from the kitchen and
            place it on the coffee table in the living room&rdquo;</p>
          <div class="video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls
              data-src="./static/videos/robot_eval/house_water_bottle_scene_000_good.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
          </div>
        </div>
        <!-- Slide 4: cup 301 -->
        <div class="results-item">
          <p class="has-text-centered has-text-grey is-italic mb-2">&ldquo;Pick a cup from the floor and place it in the
            sink&rdquo;</p>
          <div class="video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls
              data-src="./static/videos/robot_eval/room_cup_scene_301_good.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
          </div>
        </div>
        <!-- Slide 5: fruit bowl 016 -->
        <div class="results-item">
          <p class="has-text-centered has-text-grey is-italic mb-2">&ldquo;Pick a fruit from the fruit bowl and place it
            on a plate on the dining table&rdquo;</p>
          <div class="video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls
              data-src="./static/videos/robot_eval/room_fruit_bowl_scene_016_good.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
          </div>
        </div>
        <!-- Slide 6: coke can 216 -->
        <div class="results-item">
          <p class="has-text-centered has-text-grey is-italic mb-2">&ldquo;Pick a coke can from the shelf and place it
            on the table&rdquo;</p>
          <div class="video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls
              data-src="./static/videos/robot_eval/room_coke_can_scene_216_good.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
          </div>
        </div>
        <!-- Slide 7: water bottle 008 -->
        <div class="results-item">
          <p class="has-text-centered has-text-grey is-italic mb-2">&ldquo;Bring the water bottle from the kitchen and
            place it on the coffee table in the living room&rdquo;</p>
          <div class="video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls
              data-src="./static/videos/robot_eval/house_water_bottle_scene_008_good.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
          </div>
        </div>
        <!-- Slide 8: cup 305 -->
        <div class="results-item">
          <p class="has-text-centered has-text-grey is-italic mb-2">&ldquo;Pick a cup from the floor and place it in the
            sink&rdquo;</p>
          <div class="video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls
              data-src="./static/videos/robot_eval/room_cup_scene_305_good.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
          </div>
        </div>
        <!-- Slide 9: fruit bowl 019 -->
        <div class="results-item">
          <p class="has-text-centered has-text-grey is-italic mb-2">&ldquo;Pick a fruit from the fruit bowl and place it
            on a plate on the dining table&rdquo;</p>
          <div class="video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls
              data-src="./static/videos/robot_eval/room_fruit_bowl_scene_019_good.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
          </div>
        </div>
        <!-- Slide 10: coke can 220 -->
        <div class="results-item">
          <p class="has-text-centered has-text-grey is-italic mb-2">&ldquo;Pick a coke can from the shelf and place it
            on the table&rdquo;</p>
          <div class="video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls
              data-src="./static/videos/robot_eval/room_coke_can_scene_220_good.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
          </div>
        </div>
        <!-- Slide 11: fruit bowl 013 (trimmed) -->
        <div class="results-item">
          <p class="has-text-centered has-text-grey is-italic mb-2">&ldquo;Pick a fruit from the fruit bowl and place it
            on a plate on the dining table&rdquo;</p>
          <div class="video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls
              data-src="./static/videos/robot_eval/room_fruit_bowl_scene_013_good.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
          </div>
        </div>
        <!-- Slide 12: coke can 202 -->
        <div class="results-item">
          <p class="has-text-centered has-text-grey is-italic mb-2">&ldquo;Pick a coke can from the shelf and place it
            on the table&rdquo;</p>
          <div class="video-wrapper"
            style="position: relative; display: inline-block; width: 100%; aspect-ratio: 16 / 9;">
            <video class="lazy-video" muted playsinline controls
              data-src="./static/videos/robot_eval/room_coke_can_scene_202_good.mp4"
              style="width: 100%; height: 100%; object-fit: contain;"></video>
            <div class="video-spinner"></div>
          </div>
        </div>
      </div>
      <div class="content has-text-justified mt-4">
        <p>
          The videos above show rollouts of a model-based pick-and-place policy
          executing across SceneSmith-generated scenes. For each task, an LLM
          produces diverse scene prompts and SceneSmith generates 25 unique
          environments, yielding 100 evaluation scenes spanning four
          manipulation tasks. A vision-language model parses each task into
          structured goal components, and the policy plans collision-free
          motions via RRT-Connect. These rollouts serve as inputs to our
          <strong>automatic evaluation system</strong>: an agentic evaluator
          that verifies task success through simulator state queries and visual
          observations&mdash;without hand-crafted success predicates. The
          evaluator achieves 99.7% agreement with human labels, confirming
          that SceneSmith-generated scenes enable scalable, fully automatic
          policy evaluation.
        </p>
      </div>
    </div>
  </section>
  <section class="section" id="overview-video-section">
    <div class="container is-max-desktop">
      <h2 class="title is-3 has-text-centered fade-in">Method Overview Video</h2>
      <div class="content has-text-centered fade-in">
        <iframe style="aspect-ratio: 16 / 9; width: 100%; border-radius: var(--radius);"
          src="https://www.youtube.com/embed/V5Sg2NPqJb8" allowfullscreen>
        </iframe>
      </div>
    </div>
  </section>

  <!-- Teaser Figure (from paper) -->
  <section class="section teaser-section" id="teaser-figure-section">
    <div class="container is-max-widescreen">
      <h2 class="title is-3 has-text-centered fade-in">System Overview</h2>
      <div class="content has-text-centered fade-in">
        <img src="./static/images/teaser.webp" alt="SceneSmith teaser showing a generated community center scene"
          style="width: 100%;">
      </div>
      <div class="content has-text-justified fade-in">
        <p>
          <strong>Fully automated text-to-scene generation.</strong> This entire community center was generated by
          SceneSmith without any human intervention, from a single 151-word text prompt. Beyond explicitly specified
          elements, SceneSmith places additional
          objects from inferred contextual information, such as ping pong paddles and balls placed near a ping pong
          table. Objects are generated on-demand, are fully separable (non-composite), and include estimated
          physical properties, enabling direct interaction within a simulation. The resulting scenes are immediately
          usable in arbitrary physics simulators (robots added for demonstration).
        </p>
      </div>
    </div>
  </section>

  <!-- Authors -->
  <section class="section section-alt" id="authors-section">
    <div class="container is-max-desktop has-text-centered">
      <h2 class="title is-3 fade-in">Authors</h2>
      <p class="is-size-5 fade-in" style="color: var(--text-secondary);">
        <a href="https://nepfaff.github.io/" target="_blank" rel="noopener noreferrer">Nicholas Pfaff</a><sup>1</sup>,
        <a href="https://tommycohn.com/" target="_blank" rel="noopener noreferrer">Thomas Cohn</a><sup>1</sup>,
        <a href="https://zakharos.github.io/" target="_blank" rel="noopener noreferrer">Sergey Zakharov</a><sup>2</sup>,
        <a href="https://www.linkedin.com/in/rick-cory-31a68979/" target="_blank" rel="noopener noreferrer">Rick
          Cory</a><sup>2</sup>,
        <a href="https://locomotion.csail.mit.edu/russt.html" target="_blank" rel="noopener noreferrer">Russ
          Tedrake</a><sup>1</sup> <br />
        <sup>1</sup>Massachusetts Institute of Technology,
        <sup>2</sup>Toyota Research Institute
      </p>
    </div>
  </section>

  <!-- BibTeX -->
  <section class="section" id="bibtex-section">
    <div class="container is-max-desktop">
      <h2 class="title is-3 has-text-centered fade-in">Citation</h2>
      <div class="fade-in">
        <pre
          style="background: var(--surface-dark); color: rgba(255,255,255,0.8); border-radius: var(--radius); padding: 1.5rem; font-size: 0.85rem; overflow-x: auto;"><code>@misc{scenesmith2026,
  title={SceneSmith: Agentic Generation of Simulation-Ready Indoor Scenes},
  author={Nicholas Pfaff and Thomas Cohn and Sergey Zakharov and Rick Cory and Russ Tedrake},
  year={2026},
  eprint={2602.09153},
  archivePrefix={arXiv},
  primaryClass={cs.RO},
  url={https://arxiv.org/abs/2602.09153},
}</code></pre>
      </div>
    </div>
  </section>

  <section class="section section-alt" id="acknowledgements-section">
    <div class="container is-max-desktop">
      <h2 class="title is-3 has-text-centered fade-in">Acknowledgements</h2>
      <div class="fade-in" style="max-width: 800px; margin: 0 auto;">
        <p style="line-height: 1.8; text-align: justify;">
          This work was partially supported by Amazon.com (PO No. 2D-19158853), the Office of Naval Research (ONR) under
          Grant No. N00014-22-1-2121, the Toyota Research Institute (TRI), and the National Science Foundation Graduate
          Research Fellowship Program under Grant No. 2141064. This article reflects only the views of the authors and
          not those of TRI or any other Toyota entity. Any opinions, findings, and conclusions or recommendations
          expressed in this material are those of the authors and do not necessarily reflect the views of the National
          Science Foundation or other funding organizations.
        </p>
        <p style="line-height: 1.8; text-align: justify; margin-top: 1rem;">
          We thank Hongkai Dai, Jeremy Binagia, Peter Werner, and Tom Erez for helpful discussions. We also thank
          Patrick Farrell for assistance with the videos.
        </p>
      </div>
    </div>
  </section>

  <!-- Fullscreen Viewer Modal -->
  <div class="modal" id="viewer-fullscreen-modal">
    <div class="modal-background" id="fullscreen-backdrop"></div>
    <div class="modal-content viewer-fullscreen-modal">
      <div class="notification is-info is-light fullscreen-prompt" id="fullscreen-prompt"></div>
      <div class="fullscreen-viewer" id="fullscreen-canvas">
        <!-- Fullscreen floating controls -->
        <div class="viewer-controls" id="fullscreen-controls">
          <button class="button is-small" id="fullscreen-help-btn" title="Help">
            <span class="icon"><i class="fas fa-question"></i></span>
          </button>
          <button class="button is-small" id="fullscreen-frame-btn" title="Frame selected (F)" style="display: none;">
            <span class="icon"><i class="fas fa-crosshairs"></i></span>
          </button>
          <button class="button is-small" id="fullscreen-hide-btn" title="Hide selected (H)" style="display: none;">
            <span class="icon"><i class="fas fa-eye-slash"></i></span>
          </button>
          <button class="button is-small is-warning" id="fullscreen-show-all-btn" title="Show all hidden"
            style="display: none;">
            <span class="icon"><i class="fas fa-eye"></i></span>
            <span>Show <span id="fullscreen-hidden-count">0</span></span>
          </button>
          <button class="button is-small" id="fullscreen-reset-btn" title="Reset camera (R)">
            <span class="icon"><i class="fas fa-undo"></i></span>
          </button>
        </div>
        <!-- Fullscreen help tooltip -->
        <div class="help-tooltip" id="fullscreen-help">
          <ul>
            <li><strong>Rotate:</strong> Left-click + drag</li>
            <li><strong>Pan:</strong> Right-click + drag</li>
            <li><strong>Zoom:</strong> Scroll wheel</li>
            <li><strong>Select:</strong> Click on object</li>
            <li><kbd>F</kbd> Frame selected object</li>
            <li><kbd>H</kbd> Hide selected object</li>
            <li><kbd>R</kbd> Reset camera</li>
            <li><kbd>Esc</kbd> Exit fullscreen</li>
          </ul>
        </div>
      </div>
    </div>
    <button class="modal-close is-large" aria-label="close" id="fullscreen-close-btn"></button>
  </div>

  <!-- Isolated Viewer Fullscreen Modal -->
  <div class="modal" id="isolated-fullscreen-modal">
    <div class="modal-background" id="isolated-fullscreen-backdrop"></div>
    <div class="modal-content">
      <div class="isolated-fullscreen-name" id="isolated-fullscreen-name"></div>
      <div class="fullscreen-isolated-canvas" id="isolated-fullscreen-canvas">
        <div class="viewer-controls" id="isolated-fullscreen-controls">
          <button class="button is-small is-outlined" id="isolated-fs-collision-btn" style="display:none;">
            <span class="icon"><i class="fas fa-cubes"></i></span>
            <span>Collision</span>
          </button>
          <button class="button is-small is-outlined" id="isolated-fs-inertia-btn" style="display:none;">
            <span class="icon"><i class="fas fa-atom"></i></span>
            <span>Inertia</span>
          </button>
        </div>
      </div>
    </div>
    <button class="modal-close is-large" aria-label="close" id="isolated-fullscreen-close-btn"></button>
  </div>

  <footer class="footer">
    <div class="container is-max-widescreen">
      <div class="columns">
        <div class="column is-6">
          <div class="footer-brand">
            <img src="./static/images/symbol_no_text.svg" alt=""> SceneSmith
          </div>
          <p class="footer-tagline">
            Agentic generation of simulation-ready indoor scenes from natural language prompts.
          </p>
        </div>
        <div class="column is-6" style="display: flex; align-items: center; justify-content: flex-end;">
          <div class="footer-links">
            <a href="#hero"><i class="fas fa-arrow-up"></i> Back to top</a>
            <a href="#buildup-section">Construction</a>
            <a href="#room-scenes-section">Explore Scenes</a>
            <a href="#robot-eval-section">Robot Eval</a>
          </div>
        </div>
      </div>
      <hr class="footer-divider">
      <div class="footer-bottom">
        <p>Template adapted from <a href="https://github.com/nerfies/nerfies.github.io" target="_blank"
            rel="noopener noreferrer" style="color: rgba(255,255,255,0.5);">Nerfies</a></p>
        <p>&copy; 2026</p>
      </div>
    </div>
  </footer>

  <!-- 3D Viewer Initialization -->
  <script type="module">
    import { SceneSmithViewer } from './static/js/viewer/SceneSmithViewer.js';
    import { MetadataManager } from './static/js/viewer/MetadataManager.js';
    import { SCENES, getSceneById, searchScenes } from './static/js/viewer/scene-data.js';

    // Helper to truncate prompt for dropdown display
    function truncatePrompt(prompt, maxLength = 80) {
      if (prompt.length <= maxLength) return prompt;
      return prompt.substring(0, maxLength) + '...';
    }

    // Populate dropdown with scenes
    function populateDropdown(selectId, scenes) {
      const select = document.getElementById(selectId);
      scenes.forEach((scene, index) => {
        const option = document.createElement('option');
        option.value = scene.id;
        option.textContent = truncatePrompt(scene.prompt);
        option.dataset.prompt = scene.prompt;
        option.dataset.path = scene.path;
        select.appendChild(option);
      });
    }

    // Filter dropdown based on search query
    function filterDropdown(selectId, scenes, query) {
      const select = document.getElementById(selectId);
      const lowerQuery = query.toLowerCase();

      // Clear existing options except first
      while (select.options.length > 1) {
        select.remove(1);
      }

      // Filter and re-add matching scenes
      const filtered = query
        ? scenes.filter(s => s.prompt.toLowerCase().includes(lowerQuery))
        : scenes;

      filtered.forEach(scene => {
        const option = document.createElement('option');
        option.value = scene.id;
        option.textContent = truncatePrompt(scene.prompt);
        option.dataset.prompt = scene.prompt;
        option.dataset.path = scene.path;
        select.appendChild(option);
      });

      // Reset selection to show placeholder when searching
      if (query) {
        select.selectedIndex = 0;
      }

      // Show match count feedback
      const firstOption = select.options[0];
      if (query) {
        firstOption.textContent = filtered.length > 0
          ? `${filtered.length} scene${filtered.length !== 1 ? 's' : ''} found...`
          : 'No scenes found...';
      } else {
        firstOption.textContent = 'Choose a scene...';
      }
    }

    // Update prompt display
    function updatePromptDisplay(promptId, prompt) {
      const container = document.getElementById(promptId);
      if (prompt) {
        container.innerHTML = `<span class="prompt-text">"${prompt}"</span>`;
      } else {
        container.innerHTML = '<span class="prompt-placeholder">Select a scene to see its prompt</span>';
      }
    }

    // Show/hide progress bar. value=-1 means indeterminate (no Content-Length).
    function setProgress(progressId, value, visible) {
      const wrapper = document.getElementById(progressId);
      const progress = wrapper.querySelector('progress');
      if (visible) {
        wrapper.classList.remove('is-hidden');
        if (value < 0) {
          // Indeterminate: remove value attribute so the bar pulses
          progress.removeAttribute('value');
        } else {
          progress.value = value;
        }
      } else {
        wrapper.classList.add('is-hidden');
        progress.value = 0;
      }
    }

    // Helper: format object name for display
    function formatObjectName(name) {
      return name
        .replace(/_\d+$/, '') // Remove trailing _N
        .replace(/_/g, ' ')
        .replace(/\b\w/g, c => c.toUpperCase());
    }

    // Helper: populate metadata UI
    function populateMetadata(prefix, meta) {
      const nameEl = document.getElementById(`${prefix}-meta-name`);
      const tagsEl = document.getElementById(`${prefix}-meta-tags`);
      const massEl = document.getElementById(`${prefix}-meta-mass`);
      const collisionBtn = document.getElementById(`${prefix}-collision-btn`);
      const inertiaBtn = document.getElementById(`${prefix}-inertia-btn`);
      const jointControls = document.getElementById(`${prefix}-joint-controls`);

      if (!meta) {
        nameEl.textContent = '';
        tagsEl.innerHTML = '';
        massEl.textContent = '';
        collisionBtn.style.display = 'none';
        inertiaBtn.style.display = 'none';
        jointControls.innerHTML = '';
        return;
      }

      nameEl.textContent = formatObjectName(meta.name || meta.object_id);

      // Tags
      let tagsHtml = '';
      if (meta.object_type) {
        tagsHtml += `<span class="meta-tag type-tag">${meta.object_type}</span>`;
      }
      if (meta.is_articulated) {
        tagsHtml += `<span class="meta-tag articulated-tag">Articulated</span>`;
      }
      tagsEl.innerHTML = tagsHtml;

      // Mass
      const totalMass = MetadataManager.getTotalMass(meta);
      massEl.textContent = totalMass > 0 ? `Mass: ${totalMass.toFixed(2)} kg` : '';

      // Show overlay buttons (hide for floor and wall objects)
      // Don't reset is-active class here — that's managed by applyOverlayMode
      const hideOverlays = meta.object_type === 'floor' || meta.object_type === 'wall';
      collisionBtn.style.display = hideOverlays ? 'none' : 'inline-flex';
      inertiaBtn.style.display = (hideOverlays || !meta.physics) ? 'none' : 'inline-flex';
    }

    // Helper: create joint sliders
    function createJointControls(prefix, meta, viewer) {
      const container = document.getElementById(`${prefix}-joint-controls`);
      container.innerHTML = '';

      if (!meta || !meta.is_articulated || !meta.physics || !meta.physics.joints) return;

      const joints = meta.physics.joints;
      const jointEntries = Object.entries(joints);
      if (jointEntries.length === 0) return;

      const title = document.createElement('div');
      title.className = 'joint-controls-title';
      title.textContent = 'Joint Controls';
      container.appendChild(title);

      for (const [jointName, joint] of jointEntries) {
        const group = document.createElement('div');
        group.className = 'joint-slider-group';

        const isRevolute = joint.type === 'revolute';
        const lower = joint.limits ? joint.limits.lower : 0;
        const upper = joint.limits ? joint.limits.upper : 0;
        const range = upper - lower;
        const step = range !== 0 ? range / 100 : 0.01;

        // Label row
        const label = document.createElement('div');
        label.className = 'joint-slider-label';
        const typeBadge = isRevolute ? 'R' : 'P';
        const badgeClass = isRevolute ? 'revolute' : 'prismatic';
        label.innerHTML = `
          <span class="joint-name">${joint.child_link}</span>
          <span class="joint-type-badge ${badgeClass}">${typeBadge}</span>
        `;
        group.appendChild(label);

        // Slider
        const slider = document.createElement('input');
        slider.type = 'range';
        slider.min = lower;
        slider.max = upper;
        slider.step = step;
        slider.value = 0;
        // Prevent pointer events from bubbling to OrbitControls
        slider.addEventListener('pointerdown', (e) => e.stopPropagation());
        slider.addEventListener('touchstart', (e) => e.stopPropagation(), { passive: true });
        group.appendChild(slider);

        // Value display
        const valueDisplay = document.createElement('div');
        valueDisplay.className = 'joint-slider-value';
        valueDisplay.textContent = isRevolute ? '0.0°' : '0.000 m';
        group.appendChild(valueDisplay);

        slider.addEventListener('input', () => {
          const val = parseFloat(slider.value);
          if (isRevolute) {
            valueDisplay.textContent = (val * 180 / Math.PI).toFixed(1) + '°';
          } else {
            valueDisplay.textContent = val.toFixed(3) + ' m';
          }
          viewer.applyJointTransform(joint, val);
        });

        container.appendChild(group);
      }
    }

    // Helper: clear metadata display
    function clearMetadata(prefix) {
      document.getElementById(`${prefix}-meta-name`).textContent = '';
      document.getElementById(`${prefix}-meta-tags`).innerHTML = '';
      document.getElementById(`${prefix}-meta-mass`).textContent = '';
      document.getElementById(`${prefix}-collision-btn`).style.display = 'none';
      document.getElementById(`${prefix}-inertia-btn`).style.display = 'none';
      document.getElementById(`${prefix}-joint-controls`).innerHTML = '';
    }

    // Track hide timers per prefix to avoid race conditions
    const progressHideTimers = {};

    // Setup a viewer section
    function setupViewer(prefix, scenes) {
      const viewer = new SceneSmithViewer(
        document.getElementById(`${prefix}-viewer`),
        {
          isolatedContainer: document.getElementById(`${prefix}-isolated-viewer`),
          onProgress: (percent) => {
            // Cancel any pending hide timer from a previous load
            if (progressHideTimers[prefix]) {
              clearTimeout(progressHideTimers[prefix]);
              progressHideTimers[prefix] = null;
            }
            setProgress(`${prefix}-progress`, percent, true);
            if (percent >= 100) {
              progressHideTimers[prefix] = setTimeout(() => {
                setProgress(`${prefix}-progress`, 100, false);
                progressHideTimers[prefix] = null;
              }, 300);
            }
          },
          onSelect: (object, name, meta) => {
            document.getElementById(`${prefix}-no-selection`).classList.add('is-hidden');
            document.getElementById(`${prefix}-selection-info`).classList.remove('is-hidden');
            // Show frame and hide buttons
            document.getElementById(`${prefix}-frame-btn`).style.display = 'inline-flex';
            document.getElementById(`${prefix}-hide-btn`).style.display = 'inline-flex';

            // Populate metadata
            populateMetadata(prefix, meta);
            createJointControls(prefix, meta, viewer);

            // Store current object id and meta for overlay toggling
            viewer._currentSelectedObjectId = object.name;
            viewer._currentSelectedMeta = meta;

            // Re-apply active overlay mode to the newly selected object
            if (viewer._applyOverlayMode) {
              viewer._applyOverlayMode();
            }

            // Also update fullscreen controls if in fullscreen mode
            if (document.getElementById('viewer-fullscreen-modal').classList.contains('is-active')) {
              document.getElementById('fullscreen-frame-btn').style.display = 'inline-flex';
              document.getElementById('fullscreen-hide-btn').style.display = 'inline-flex';
            }
          },
          onClearSelection: () => {
            document.getElementById(`${prefix}-no-selection`).classList.remove('is-hidden');
            document.getElementById(`${prefix}-selection-info`).classList.add('is-hidden');
            // Hide frame and hide buttons
            document.getElementById(`${prefix}-frame-btn`).style.display = 'none';
            document.getElementById(`${prefix}-hide-btn`).style.display = 'none';

            // Clear metadata
            clearMetadata(prefix);
            viewer._currentSelectedObjectId = null;
            viewer._currentSelectedMeta = null;

            // Also update fullscreen controls if in fullscreen mode
            if (document.getElementById('viewer-fullscreen-modal').classList.contains('is-active')) {
              document.getElementById('fullscreen-frame-btn').style.display = 'none';
              document.getElementById('fullscreen-hide-btn').style.display = 'none';
            }
          },
          onHide: (hiddenCount) => {
            document.getElementById(`${prefix}-hidden-count`).textContent = hiddenCount;
            document.getElementById(`${prefix}-show-all-btn`).style.display = hiddenCount > 0 ? 'inline-flex' : 'none';
            // Also update fullscreen controls if in fullscreen mode
            if (document.getElementById('viewer-fullscreen-modal').classList.contains('is-active')) {
              document.getElementById('fullscreen-hidden-count').textContent = hiddenCount;
              document.getElementById('fullscreen-show-all-btn').style.display = hiddenCount > 0 ? 'inline-flex' : 'none';
            }
          },
          onShowAll: () => {
            document.getElementById(`${prefix}-hidden-count`).textContent = '0';
            document.getElementById(`${prefix}-show-all-btn`).style.display = 'none';
            // Also update fullscreen controls if in fullscreen mode
            if (document.getElementById('viewer-fullscreen-modal').classList.contains('is-active')) {
              document.getElementById('fullscreen-hidden-count').textContent = '0';
              document.getElementById('fullscreen-show-all-btn').style.display = 'none';
            }
          }
        }
      );

      // Populate dropdown
      populateDropdown(`${prefix}-selector`, scenes);

      // Search filtering
      document.getElementById(`${prefix}-search`).addEventListener('input', (e) => {
        filterDropdown(`${prefix}-selector`, scenes, e.target.value);
      });

      // Scene selection
      document.getElementById(`${prefix}-selector`).addEventListener('change', async (e) => {
        const select = e.target;
        if (select.value) {
          const option = select.options[select.selectedIndex];
          // Cancel any pending hide timer before showing new progress
          if (progressHideTimers[prefix]) {
            clearTimeout(progressHideTimers[prefix]);
            progressHideTimers[prefix] = null;
          }
          setProgress(`${prefix}-progress`, 0, true);
          try {
            await viewer.loadScene(option.dataset.path, select.value);
            updatePromptDisplay(`${prefix}-prompt`, option.dataset.prompt);
          } catch (err) {
            // AbortError means a newer load superseded this one — don't touch the progress bar
            if (err.name === 'AbortError') return;
            console.error('Failed to load scene:', err);
            setProgress(`${prefix}-progress`, 0, false);
          }
        }
      });

      // Random button
      document.getElementById(`${prefix}-random-btn`).addEventListener('click', () => {
        const randomIndex = Math.floor(Math.random() * scenes.length);
        const scene = scenes[randomIndex];
        const select = document.getElementById(`${prefix}-selector`);
        select.value = scene.id;
        select.dispatchEvent(new Event('change'));
      });

      // Reset camera button
      document.getElementById(`${prefix}-reset-btn`).addEventListener('click', () => {
        viewer.resetCamera();
      });

      // Frame selected button
      document.getElementById(`${prefix}-frame-btn`).addEventListener('click', () => {
        viewer.frameSelected();
      });

      // Hide selected button
      document.getElementById(`${prefix}-hide-btn`).addEventListener('click', () => {
        viewer.hideSelected();
      });

      // Show all button
      document.getElementById(`${prefix}-show-all-btn`).addEventListener('click', () => {
        viewer.showAll();
      });

      // Help button
      document.getElementById(`${prefix}-help-btn`).addEventListener('click', () => {
        const help = document.getElementById(`${prefix}-help`);
        help.classList.toggle('is-visible');
      });

      // Track which overlay mode is active: 'none', 'collision', or 'inertia'
      let activeOverlayMode = 'none';

      // Helper to apply the current overlay mode to the selected object
      async function applyOverlayMode() {
        const collisionBtn = document.getElementById(`${prefix}-collision-btn`);
        const inertiaBtn = document.getElementById(`${prefix}-inertia-btn`);
        const fsCollisionBtn = document.getElementById('isolated-fs-collision-btn');
        const fsInertiaBtn = document.getElementById('isolated-fs-inertia-btn');

        // Clear existing overlays first
        if (viewer.overlayManager.collisionVisible) {
          viewer.overlayManager.hideCollision(viewer.isolatedViewer.scene);
          viewer.isolatedViewer.setVisualVisible(true);
        }
        if (viewer.overlayManager.inertiaVisible) {
          viewer.overlayManager.hideInertia();
        }

        collisionBtn.classList.remove('is-active');
        inertiaBtn.classList.remove('is-active');
        fsCollisionBtn.classList.remove('is-active');
        fsInertiaBtn.classList.remove('is-active');

        // Hide joint sliders when collision mesh replaces the visual
        const jointControls = document.getElementById(`${prefix}-joint-controls`);
        if (jointControls) {
          jointControls.style.display = activeOverlayMode === 'collision' ? 'none' : '';
        }

        if (activeOverlayMode === 'collision' && viewer._currentSelectedObjectId) {
          const collisionPath = viewer.metadataManager.getCollisionPath(viewer._currentSelectedObjectId);
          if (collisionPath) {
            await viewer.overlayManager.showCollision(collisionPath, viewer.isolatedViewer.scene, viewer.isolatedViewer.objectTransform, viewer.isolatedViewer.currentObject);
            viewer.isolatedViewer.setVisualVisible(false);
            collisionBtn.classList.add('is-active');
            fsCollisionBtn.classList.add('is-active');
          }
        } else if (activeOverlayMode === 'inertia' && viewer._currentSelectedMeta && viewer._currentSelectedMeta.physics) {
          viewer.overlayManager.showInertia(
            viewer._currentSelectedMeta.physics,
            viewer.isolatedViewer.currentObject
          );
          inertiaBtn.classList.add('is-active');
          fsInertiaBtn.classList.add('is-active');
        }
      }

      // Store applyOverlayMode on the viewer so onSelect can call it
      viewer._applyOverlayMode = applyOverlayMode;

      // Shared toggle functions
      async function toggleCollision() {
        if (!viewer._currentSelectedObjectId) return;
        activeOverlayMode = activeOverlayMode === 'collision' ? 'none' : 'collision';
        await applyOverlayMode();
      }

      async function toggleInertia() {
        if (!viewer._currentSelectedMeta || !viewer._currentSelectedMeta.physics) return;
        activeOverlayMode = activeOverlayMode === 'inertia' ? 'none' : 'inertia';
        await applyOverlayMode();
      }

      // Store toggles on viewer for fullscreen modal access
      viewer._toggleCollision = toggleCollision;
      viewer._toggleInertia = toggleInertia;

      // Collision toggle button
      document.getElementById(`${prefix}-collision-btn`).addEventListener('click', toggleCollision);

      // Inertia toggle button
      document.getElementById(`${prefix}-inertia-btn`).addEventListener('click', toggleInertia);

      // Fullscreen button - opens modal overlay
      const fullscreenBtn = document.getElementById(`${prefix}-fullscreen-btn`);
      if (fullscreenBtn) {
        fullscreenBtn.addEventListener('click', () => {
          openFullscreenModal(viewer, prefix);
        });
      }

      // Hide progress initially
      setProgress(`${prefix}-progress`, 0, false);

      return { viewer, scenes };
    }

    // Fullscreen modal state
    let fullscreenViewer = null;
    let originalContainer = null;
    let currentPrefix = null;

    function openFullscreenModal(viewer, prefix) {
      const modal = document.getElementById('viewer-fullscreen-modal');
      const fullscreenCanvas = document.getElementById('fullscreen-canvas');
      const promptDisplay = document.getElementById('fullscreen-prompt');

      // Get current prompt
      const currentPrompt = document.getElementById(`${prefix}-prompt`).querySelector('.prompt-text');
      if (currentPrompt) {
        promptDisplay.innerHTML = currentPrompt.innerHTML;
        promptDisplay.style.display = 'block';
      } else {
        promptDisplay.style.display = 'none';
      }

      // Store original container and move renderer
      originalContainer = viewer.container;
      currentPrefix = prefix;

      // Move the canvas to fullscreen container
      if (viewer.renderer && viewer.renderer.domElement) {
        fullscreenCanvas.appendChild(viewer.renderer.domElement);
        viewer.container = fullscreenCanvas;

        // Force proper pixel ratio for fullscreen
        viewer.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

        // Wait for modal to be visible, then resize
        requestAnimationFrame(() => {
          viewer.handleResize();
        });
      }

      fullscreenViewer = viewer;
      modal.classList.add('is-active');
      document.body.style.overflow = 'hidden';
      document.getElementById('site-nav').style.display = 'none';

      // Sync control state
      updateFullscreenControls();
    }

    function closeFullscreenModal() {
      const modal = document.getElementById('viewer-fullscreen-modal');

      if (fullscreenViewer && originalContainer) {
        // Move canvas back to original container
        originalContainer.appendChild(fullscreenViewer.renderer.domElement);
        fullscreenViewer.container = originalContainer;
        fullscreenViewer.handleResize();
      }

      modal.classList.remove('is-active');
      document.body.style.overflow = '';
      document.getElementById('site-nav').style.display = '';
      fullscreenViewer = null;
      originalContainer = null;
      currentPrefix = null;
    }

    // Update fullscreen control visibility based on viewer state
    function updateFullscreenControls() {
      if (!fullscreenViewer) return;

      const hasSelection = fullscreenViewer.selectedObject !== null;
      const hiddenCount = fullscreenViewer.getHiddenCount();

      document.getElementById('fullscreen-frame-btn').style.display = hasSelection ? 'inline-flex' : 'none';
      document.getElementById('fullscreen-hide-btn').style.display = hasSelection ? 'inline-flex' : 'none';
      document.getElementById('fullscreen-show-all-btn').style.display = hiddenCount > 0 ? 'inline-flex' : 'none';
      document.getElementById('fullscreen-hidden-count').textContent = hiddenCount;
    }

    // Setup fullscreen modal close handlers
    function setupFullscreenModal() {
      const backdrop = document.getElementById('fullscreen-backdrop');
      const closeBtn = document.getElementById('fullscreen-close-btn');

      // Click backdrop to close
      backdrop.addEventListener('click', closeFullscreenModal);

      // Click X button to close
      closeBtn.addEventListener('click', closeFullscreenModal);

      // Escape key to close
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && document.getElementById('viewer-fullscreen-modal').classList.contains('is-active')) {
          closeFullscreenModal();
        }
      });

      // Fullscreen control buttons
      document.getElementById('fullscreen-frame-btn').addEventListener('click', () => {
        if (fullscreenViewer) {
          fullscreenViewer.frameSelected();
        }
      });

      document.getElementById('fullscreen-hide-btn').addEventListener('click', () => {
        if (fullscreenViewer) {
          fullscreenViewer.hideSelected();
          updateFullscreenControls();
          // Also update the main viewer's UI
          if (currentPrefix) {
            document.getElementById(`${currentPrefix}-frame-btn`).style.display = 'none';
            document.getElementById(`${currentPrefix}-hide-btn`).style.display = 'none';
            const hiddenCount = fullscreenViewer.getHiddenCount();
            document.getElementById(`${currentPrefix}-hidden-count`).textContent = hiddenCount;
            document.getElementById(`${currentPrefix}-show-all-btn`).style.display = hiddenCount > 0 ? 'inline-flex' : 'none';
          }
        }
      });

      document.getElementById('fullscreen-show-all-btn').addEventListener('click', () => {
        if (fullscreenViewer) {
          fullscreenViewer.showAll();
          updateFullscreenControls();
          // Also update the main viewer's UI
          if (currentPrefix) {
            document.getElementById(`${currentPrefix}-hidden-count`).textContent = '0';
            document.getElementById(`${currentPrefix}-show-all-btn`).style.display = 'none';
          }
        }
      });

      document.getElementById('fullscreen-reset-btn').addEventListener('click', () => {
        if (fullscreenViewer) {
          fullscreenViewer.resetCamera();
        }
      });

      // Fullscreen help button
      document.getElementById('fullscreen-help-btn').addEventListener('click', () => {
        const help = document.getElementById('fullscreen-help');
        help.classList.toggle('is-visible');
      });
    }

    // Load a scene by selecting it in the dropdown
    async function loadFirstScene(prefix, scenes, viewer) {
      if (scenes.length > 0) {
        const select = document.getElementById(`${prefix}-selector`);
        const firstScene = scenes[0];
        select.value = firstScene.id;
        // Cancel any pending hide timer before showing new progress
        if (progressHideTimers[prefix]) {
          clearTimeout(progressHideTimers[prefix]);
          progressHideTimers[prefix] = null;
        }
        setProgress(`${prefix}-progress`, 0, true);
        try {
          await viewer.loadScene(firstScene.path, firstScene.id);
          updatePromptDisplay(`${prefix}-prompt`, firstScene.prompt);
        } catch (err) {
          if (err.name === 'AbortError') return;
          console.error('Failed to load first scene:', err);
          setProgress(`${prefix}-progress`, 0, false);
        }
      }
    }

    // Isolated viewer fullscreen modal state
    let isolatedFullscreenViewer = null;
    let isolatedOriginalContainer = null;

    function openIsolatedFullscreen(viewer, objectName) {
      const modal = document.getElementById('isolated-fullscreen-modal');
      const canvas = document.getElementById('isolated-fullscreen-canvas');
      const nameEl = document.getElementById('isolated-fullscreen-name');

      nameEl.textContent = objectName ? formatObjectName(objectName) : '';

      // Sync fullscreen overlay button visibility with panel buttons
      const meta = viewer._currentSelectedMeta;
      const fsCollisionBtn = document.getElementById('isolated-fs-collision-btn');
      const fsInertiaBtn = document.getElementById('isolated-fs-inertia-btn');
      const hideOverlays = !meta || meta.object_type === 'floor' || meta.object_type === 'wall';
      fsCollisionBtn.style.display = hideOverlays ? 'none' : 'inline-flex';
      fsInertiaBtn.style.display = (hideOverlays || !meta || !meta.physics) ? 'none' : 'inline-flex';

      // Sync active state
      fsCollisionBtn.classList.toggle('is-active', viewer.overlayManager.collisionVisible);
      fsInertiaBtn.classList.toggle('is-active', viewer.overlayManager.inertiaVisible);

      // Store original container and move renderer
      isolatedOriginalContainer = viewer.isolatedViewer.container;
      if (viewer.isolatedViewer.renderer && viewer.isolatedViewer.renderer.domElement) {
        canvas.appendChild(viewer.isolatedViewer.renderer.domElement);
        viewer.isolatedViewer.container = canvas;

        viewer.isolatedViewer.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        requestAnimationFrame(() => {
          viewer.isolatedViewer.handleResize();
        });
      }

      isolatedFullscreenViewer = viewer;
      modal.classList.add('is-active');
      document.body.style.overflow = 'hidden';
      document.getElementById('site-nav').style.display = 'none';
    }

    function closeIsolatedFullscreen() {
      const modal = document.getElementById('isolated-fullscreen-modal');

      if (isolatedFullscreenViewer && isolatedOriginalContainer) {
        isolatedOriginalContainer.appendChild(isolatedFullscreenViewer.isolatedViewer.renderer.domElement);
        isolatedFullscreenViewer.isolatedViewer.container = isolatedOriginalContainer;
        isolatedFullscreenViewer.isolatedViewer.handleResize();
      }

      modal.classList.remove('is-active');
      document.body.style.overflow = '';
      document.getElementById('site-nav').style.display = '';
      isolatedFullscreenViewer = null;
      isolatedOriginalContainer = null;
    }

    function setupIsolatedFullscreenModal() {
      document.getElementById('isolated-fullscreen-backdrop').addEventListener('click', closeIsolatedFullscreen);
      document.getElementById('isolated-fullscreen-close-btn').addEventListener('click', closeIsolatedFullscreen);
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && document.getElementById('isolated-fullscreen-modal').classList.contains('is-active')) {
          closeIsolatedFullscreen();
        }
      });

      // Fullscreen overlay toggle buttons delegate to the active viewer's toggles
      document.getElementById('isolated-fs-collision-btn').addEventListener('click', () => {
        if (isolatedFullscreenViewer && isolatedFullscreenViewer._toggleCollision) {
          isolatedFullscreenViewer._toggleCollision();
        }
      });
      document.getElementById('isolated-fs-inertia-btn').addEventListener('click', () => {
        if (isolatedFullscreenViewer && isolatedFullscreenViewer._toggleInertia) {
          isolatedFullscreenViewer._toggleInertia();
        }
      });
    }

    // Setup isolated viewer fullscreen buttons
    function setupIsolatedFullscreen(prefix, viewer) {
      const btn = document.getElementById(`${prefix}-isolated-fullscreen-btn`);
      if (!btn) return;

      btn.addEventListener('click', () => {
        const meta = viewer._currentSelectedMeta;
        const name = meta ? (meta.name || meta.object_id) : '';
        openIsolatedFullscreen(viewer, name);
      });
    }

    // Initialize when DOM is ready
    document.addEventListener('DOMContentLoaded', async () => {
      // Setup fullscreen modal handlers
      setupFullscreenModal();

      // Setup isolated viewer fullscreen modal
      setupIsolatedFullscreenModal();

      // Setup room viewer and preload first scene
      const { viewer: roomViewer, scenes: roomScenes } = setupViewer('room', SCENES.rooms);
      setupIsolatedFullscreen('room', roomViewer);
      await loadFirstScene('room', roomScenes, roomViewer);

      // Setup house viewer and preload first scene (massage parlor)
      const { viewer: houseViewer, scenes: houseScenes } = setupViewer('house', SCENES.houses);
      setupIsolatedFullscreen('house', houseViewer);
      await loadFirstScene('house', houseScenes, houseViewer);
    });
  </script>

  <!-- Scroll animations & sticky nav -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Fade-in on scroll
      const fadeEls = document.querySelectorAll('.fade-in');
      const fadeObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('is-visible');
            fadeObserver.unobserve(entry.target);
          }
        });
      }, { threshold: 0.1 });
      fadeEls.forEach(el => fadeObserver.observe(el));

      // Sticky nav - show after scrolling past hero
      const nav = document.getElementById('site-nav');
      const hero = document.querySelector('.hero-section');
      if (nav && hero) {
        const navObserver = new IntersectionObserver(([entry]) => {
          nav.classList.toggle('is-visible', !entry.isIntersecting);
        }, { threshold: 0 });
        navObserver.observe(hero);
      }

      // Active nav link highlighting
      const sections = document.querySelectorAll('section[id]');
      const navLinks = document.querySelectorAll('.site-nav .nav-links a');
      const linkObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const id = entry.target.getAttribute('id');
            navLinks.forEach(link => {
              link.classList.toggle('active', link.getAttribute('href') === '#' + id);
            });
          }
        });
      }, { threshold: 0.3 });
      sections.forEach(sec => linkObserver.observe(sec));

      // Close any fullscreen modals when clicking nav links
      navLinks.forEach(link => {
        link.addEventListener('click', () => {
          document.querySelectorAll('.modal.is-active').forEach(modal => {
            modal.classList.remove('is-active');
          });
          document.body.style.overflow = '';
        });
      });

      // Nav dropdown toggle
      const dropdownTrigger = document.querySelector('.nav-dropdown-trigger');
      const dropdown = document.querySelector('.nav-dropdown');
      if (dropdownTrigger && dropdown) {
        dropdownTrigger.addEventListener('click', (e) => {
          e.stopPropagation();
          dropdown.classList.toggle('open');
        });
        document.addEventListener('click', () => {
          dropdown.classList.remove('open');
        });
      }
    });
  </script>
</body>

</html>